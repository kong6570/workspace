<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.up366.auth.db.dao.OrganMapper">
  <resultMap id="BaseResultMap" type="com.up366.auth.db.pojo.Organ">
    <id column="org_id" jdbcType="INTEGER" property="orgId" />
    <result column="org_name" jdbcType="VARCHAR" property="orgName" />
    <result column="org_type_id" jdbcType="INTEGER" property="orgTypeId" />
    <result column="org_desc" jdbcType="VARCHAR" property="orgDesc" />
  </resultMap>
  <sql id="Base_Column_List">
    org_id, org_name, org_type_id, org_desc
  </sql>
  <select id="selectByPrimaryKey" parameterType="java.lang.Integer" resultMap="BaseResultMap">
    select 
    <include refid="Base_Column_List" />
    from adm_organs
    where org_id = #{orgId,jdbcType=INTEGER}
  </select>
  <delete id="deleteByPrimaryKey" parameterType="java.lang.Integer">
    delete from adm_organs
    where org_id = #{orgId,jdbcType=INTEGER}
  </delete>
  <insert id="insert" parameterType="com.up366.auth.db.pojo.Organ">
    insert into adm_organs (org_id, org_name, org_type_id, 
      org_desc)
    values (#{orgId,jdbcType=INTEGER}, #{orgName,jdbcType=VARCHAR}, #{orgTypeId,jdbcType=INTEGER}, 
      #{orgDesc,jdbcType=VARCHAR})
  </insert>
  <insert id="insertSelective" parameterType="com.up366.auth.db.pojo.Organ">
    insert into adm_organs
    <trim prefix="(" suffix=")" suffixOverrides=",">
      <if test="orgId != null">
        org_id,
      </if>
      <if test="orgName != null">
        org_name,
      </if>
      <if test="orgTypeId != null">
        org_type_id,
      </if>
      <if test="orgDesc != null">
        org_desc,
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides=",">
      <if test="orgId != null">
        #{orgId,jdbcType=INTEGER},
      </if>
      <if test="orgName != null">
        #{orgName,jdbcType=VARCHAR},
      </if>
      <if test="orgTypeId != null">
        #{orgTypeId,jdbcType=INTEGER},
      </if>
      <if test="orgDesc != null">
        #{orgDesc,jdbcType=VARCHAR},
      </if>
    </trim>
  </insert>
  <update id="updateByPrimaryKeySelective" parameterType="com.up366.auth.db.pojo.Organ">
    update adm_organs
    <set>
      <if test="orgName != null">
        org_name = #{orgName,jdbcType=VARCHAR},
      </if>
      <if test="orgTypeId != null">
        org_type_id = #{orgTypeId,jdbcType=INTEGER},
      </if>
      <if test="orgDesc != null">
        org_desc = #{orgDesc,jdbcType=VARCHAR},
      </if>
    </set>
    where org_id = #{orgId,jdbcType=INTEGER}
  </update>
  <update id="updateByPrimaryKey" parameterType="com.up366.auth.db.pojo.Organ">
    update adm_organs
    set org_name = #{orgName,jdbcType=VARCHAR},
      org_type_id = #{orgTypeId,jdbcType=INTEGER},
      org_desc = #{orgDesc,jdbcType=VARCHAR}
    where org_id = #{orgId,jdbcType=INTEGER}
  </update>
  
  <!-- 
      author:张静转
      time:2016-01-23 16:28:12
      remark：获取机构列表
   -->
  <select id="getOrganList" resultType="map">
  select o.org_id orgId, o.org_name orgName, ot.org_type_name orgTypeName
  from adm_organs o, adm_org_types ot
  where 1=1
  	<if test="orgId != null">
  		and o.org_id = #{orgId,jdbcType=INTEGER}
  	</if>
  	<if test="orgTypeId != null">
  		and o.org_type_id = #{orgTypeId,jdbcType=INTEGER}
  	</if>
  		and o.org_type_id = ot.org_type_id
  		order by o.org_id asc
  		limit #{pageNo, jdbcType=INTEGER} , #{pageSize, jdbcType=INTEGER}
  </select>
  
  <!-- 
      author:张静转
      time:2016-01-23 16:28:12
      remark：获取机构数量
   -->
  <select id="getOrganListCount" resultType="java.lang.Integer">
  	select count(1) from adm_organs where 1=1
  	<if test="orgId != null">
  		and org_id = #{orgId,jdbcType=INTEGER}
  	</if>
  	<if test="orgTypeId != null">
  		and org_type_id = #{orgTypeId,jdbcType=INTEGER}
  	</if>
  </select>
  <!-- 
      author:张静转
      time:2016-01-25 19:42:30
      remark：根据机构名称获取机构信息
   -->
  <select id="selectByName" parameterType="java.lang.String" resultMap="BaseResultMap">
    select
    <include refid="Base_Column_List" />
    from adm_organs
    where org_name = #{_parameter,jdbcType=VARCHAR}
  </select>
  
  <!-- 
      author:张静转
      time:2016-01-26 10:50:28
      remark：获取机构信息map，key为id，value为机构名称
   -->
  <select id="find" parameterType="com.up366.auth.common.utils.MapParam" resultType="map">
    select org_id, org_name
    from adm_organs
    <if test="organName != null">
  		where org_name like concat('%', #{organName,jdbcType=VARCHAR}, '%')
  	</if>
  </select>
  
  <select id="getOrgans" parameterType="java.lang.String" resultType="map">
  select
    org_id orgId, org_name orgName
    from adm_organs
    where org_name like concat('%', #{_parameter,jdbcType=VARCHAR}, '%')
  </select>
    <!-- 
      author:赵云慧
      time:2016-1-29 10:13:51
      remark：根据机构类型id获取机构
   -->
  <select id="selectByOrgTypeId" parameterType="java.lang.Integer" resultType="java.lang.Integer">
    SELECT  count(1) from adm_organs 
    where org_type_id = #{_parameter,jdbcType=INTEGER}
  </select>
</mapper>